function setFixed(e){if(!e)return;(window.scrollY||document.documentElement.scrollTop)>0?e.classList.add("nav-fixed"):e.classList.remove("nav-fixed")}const scrollFn=function(){const e=window.innerHeight+0,t=document.getElementById("page-header");if(setFixed(t),document.body.scrollHeight<=e)return;let n=0;window.addEventListener("scroll",utils.throttle((function(e){const o=window.scrollY||document.documentElement.scrollTop,i=function(e){const t=e>n;return n=e,t}(o);o>0?(i?t.classList.contains("nav-visible")&&t.classList.remove("nav-visible"):t.classList.contains("nav-visible")||t.classList.add("nav-visible"),t.classList.add("nav-fixed")):0===o&&t.classList.remove("nav-fixed","nav-visible"),percent()}),200))},sidebarFn=()=>{const e=document.getElementById("toggle-menu"),t=document.getElementById("sidebar-menus"),n=document.getElementById("menu-mask"),o=document.body;function i(){o.style.overflow="",o.style.paddingRight="",utils.fadeOut(n,.5),t.classList.remove("open")}e&&(e.addEventListener("click",(function(){utils.sidebarPaddingR(),o.style.overflow="hidden",utils.fadeIn(n,.5),t.classList.add("open")})),n.addEventListener("click",(e=>{t.classList.contains("open")&&i()})),window.addEventListener("resize",(e=>{t.classList.contains("open")&&i()})))},showTodayCard=()=>{const e=document.getElementById("todayCard");e&&document.getElementsByClassName("topGroup")[0].addEventListener("mouseleave",(()=>{e.classList.contains("hide")&&e.classList.remove("hide")}))},setTimeState=()=>{const e=document.getElementById("author-info__sayhi");if(e){const t=(new Date).getHours(),n=GLOBALCONFIG.lang.sayhello;let o="";t>=0&&t<=5?o=n.goodnight:t>5&&t<=10?o=n.morning:t>10&&t<=14?o=n.noon:t>14&&t<=18?o=n.afternoon:t>18&&t<=24&&(o=n.night),e.innerText=o+n.iam}},chageTimeFormate=()=>{const e=document.getElementsByTagName("time"),t=GLOBALCONFIG.lang.time;for(var n=0;n<e.length;n++){const i=e[n].getAttribute("datetime"),a=new Date(i),c=utils.timeDiff(a,new Date);var o;o=0===c?t.recent:1===c?t.yesterday:2===c?t.berforeyesterday:c<=7?c+t.daybefore:a.getFullYear()!==(new Date).getFullYear()?a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate():a.getMonth()+1+"/"+a.getDate(),e[n].textContent=o}},percent=()=>{let e=document.documentElement.scrollTop||window.pageYOffset,t=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)-document.documentElement.clientHeight,n=Math.round(e/t*100),o=document.querySelector("#percent");const i=window.scrollY+document.documentElement.clientHeight,a=document.getElementById("post-tools")||document.getElementById("footer");a.offsetTop+a.offsetHeight/2<i||n>90?(document.querySelector("#nav-totop").classList.add("long"),o.innerHTML=GLOBALCONFIG.lang.backtop,document.querySelectorAll(".needEndHide").forEach((e=>{e.classList.add("hide")}))):(document.querySelector("#nav-totop").classList.remove("long"),n>=0&&(o.innerHTML=n,document.querySelectorAll(".needEndHide").forEach((e=>{e.classList.remove("hide")}))))};class toc{static init(){const e=document.getElementById("card-toc");if(!e||!e.querySelector(".toc a"))return void(e.style.display="none");const t=document.querySelectorAll(".toc a");t.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),utils.scrollToDest(utils.getEleTop(document.getElementById(decodeURI(("toc-text"===e.target.className?e.target.parentNode.hash:e.target.hash).replace("#","")))),300)}))})),this.active(t)}static active(e){const t=document.getElementById("article-container"),n=document.getElementById("toc-content"),o=t.querySelectorAll("h1,h2,h3,h4,h5,h6");let i="";function a(t){if(0===t)return!1;let a="";if(o.forEach((function(e,n){t>utils.getEleTop(e)-80&&(a=n)})),i===a)return;i=a,document.querySelectorAll(".toc .active").forEach((e=>{e.classList.remove("active")}));const c=e[i];if(c){let t=e[i].parentNode;for(c.classList.add("active"),function(e){const t=e.getBoundingClientRect().top,o=n.scrollTop;t>document.documentElement.clientHeight-100&&(n.scrollTop=o+150),t<100&&(n.scrollTop=o-150)}(c);!t.matches(".toc");t=t.parentNode)t.matches("li")&&t.classList.add("active")}}window.tocScrollFn=utils.throttle((function(){a(window.scrollY||document.documentElement.scrollTop)}),100),window.addEventListener("scroll",tocScrollFn)}}class acrylic{static switchDarkMode(){"light"===("dark"===document.documentElement.getAttribute("data-theme")?"dark":"light")?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark"),utils.snackbarShow(GLOBALCONFIG.lang.theme.dark,!1,2e3)):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"),utils.snackbarShow(GLOBALCONFIG.lang.theme.light,!1,2e3))}static hideTodayCard(){document.getElementById("todayCard").classList.add("hide")}static toTop(){utils.scrollToDest(0)}static showConsole(){const e=document.getElementById("console");e.classList.contains("show")||e.classList.add("show")}static hideConsole(){const e=document.getElementById("console");e.classList.contains("show")&&e.classList.remove("show")}static copyPageUrl(){utils.copy(window.location.href)}static lightbox(e){window.ViewImage&&ViewImage.init(e)}static initTheme(){const e=window.matchMedia("(prefers-color-scheme: dark)").matches,t=localStorage.getItem("theme"),n=!t||"dark"!==t&&"light"!==t?e?"dark":"light":"dark"===t&&!e?"light":"light"===t&&e?"dark":t;document.documentElement.setAttribute("data-theme",n),localStorage.setItem("theme",n)}static reflashEssayWaterFall(){document.getElementById("waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall").classList.add("show")}),500)}static addRuntime(){const e=document.getElementById("runtimeshow");e&&GLOBALCONFIG.runtime&&(e.innerText=utils.timeDiff(new Date(GLOBALCONFIG.runtime),new Date)+GLOBALCONFIG.lang.time.runtime)}static lazyloadImg(){window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src",callback_error:e=>{e.setAttribute("src",GLOBALCONFIG.lazyload.error)}})}static initbbtalk(){if(document.querySelector("#bber-talk"))new Swiper(".swiper-container",{direction:"vertical",loop:!0,autoplay:{delay:3e3,pauseOnMouseEnter:!0}})}static addPhotoFigcaption(){document.querySelectorAll("#article-container img").forEach((e=>{const t=e.parentNode,n=e.getAttribute("alt");if(n){const o=document.createElement("div");o.className="img-alt is-center",o.textContent=n,t.insertBefore(o,e.nextSibling)}}))}static musicToggle(){const e=document.querySelector("#nav-music"),t=document.querySelector("meting-js"),n=document.getElementById("consoleMusic");acrylic_musicPlaying?(e.classList.remove("playing"),n.classList.remove("on"),acrylic_musicPlaying=!1,t.aplayer.pause()):(e.classList.add("playing"),n.classList.add("on"),acrylic_musicPlaying=!0,t.aplayer.play())}static scrollToComment(){utils.scrollToDest(utils.getEleTop(document.getElementById("post-comment")),300)}}class hightlight{static createEle(e,t){const n=document.createDocumentFragment(),o=document.createElement("div");o.className="highlight-tools",o.innerHTML=e+'<i class="fas fa-paste copy-button"></i>',o.children[1].addEventListener("click",(e=>{utils.copy(a.querySelector(".code").innerText)})),n.appendChild(o);const i=t.clientHeight,a=t.querySelector("table");if(GLOBALCONFIG.hightlight.limit&&i>GLOBALCONFIG.hightlight.limit+30){a.setAttribute("style",`height: ${GLOBALCONFIG.hightlight.limit}px`);const e=document.createElement("div");e.className="code-expand-btn",e.innerHTML='<i class="fas fa-angle-double-down"></i>',e.addEventListener("click",(e=>{a.setAttribute("style",`height: ${i}px`),"code-expand-btn"!==e.target.className?e.target.parentNode.classList.add("expand-done"):e.target.classList.add("expand-done")})),n.appendChild(e)}t.insertBefore(n,t.firstChild)}static init(){const e=document.querySelectorAll("figure.highlight"),t=this;e.forEach((function(e){let n=e.getAttribute("class").split(" ")[1];"plaintext"!==n&&void 0!==n||(n="Code");const o=`<div class="code-lang">${n.toUpperCase()}</div>`;t.createEle(o,e)}))}}class tabs{static init(){this.clickFnOfTabs(),this.backToTop()}static clickFnOfTabs(){document.querySelectorAll("#article-container .tab > button").forEach((function(e){e.addEventListener("click",(function(e){const t=this,n=t.parentNode;if(!n.classList.contains("active")){const e=n.parentNode.nextElementSibling,o=utils.siblings(n,".active")[0];o&&o.classList.remove("active"),n.classList.add("active");const i=t.getAttribute("data-href").replace("#","");[...e.children].forEach((e=>{e.id===i?e.classList.add("active"):e.classList.remove("active")}))}}))}))}static backToTop(){document.querySelectorAll("#article-container .tabs .tab-to-top").forEach((function(e){e.addEventListener("click",(function(){utils.scrollToDest(utils.getEleTop(e.parentElement.parentElement.parentNode),300)}))}))}}window.refreshFn=()=>{scrollFn(),sidebarFn(),setTimeState(),GLOBALCONFIG.comment.enable&&newestCommentInit(),chageTimeFormate(),acrylic.addRuntime(),acrylic.addPhotoFigcaption(),GLOBALCONFIG.lazyload.enable&&acrylic.lazyloadImg(),GLOBALCONFIG.lightbox&&acrylic.lightbox("#article-container img, #bber .bber-content-img img, #album_detail album-content-img img"),GLOBALCONFIG.randomlinks&&randomLinksList(),PAGECONFIG.toc&&toc.init(),(PAGECONFIG.is_post||PAGECONFIG.is_page)&&(GLOBALCONFIG.hightlight.enable&&hightlight.init(),tabs.init()),PAGECONFIG.comment&&initComment(),PAGECONFIG.is_home&&(showTodayCard(),acrylic.initbbtalk()),PAGECONFIG.is_page&&"says"===PAGECONFIG.page&&acrylic.reflashEssayWaterFall(),PAGECONFIG.is_page&&document.getElementById("album_detail")&&acrylic.reflashEssayWaterFall(),GLOBALCONFIG.covercolor&&coverColor()},acrylic.initTheme();let acrylic_musicPlaying=!1;document.addEventListener("DOMContentLoaded",(function(){refreshFn()})),document.addEventListener("pjax:complete",(()=>{window.refreshFn()}));